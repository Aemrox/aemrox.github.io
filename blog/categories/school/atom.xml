<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: School | Ride or Pry]]></title>
  <link href="http://aemrox.github.io/blog/categories/school/atom.xml" rel="self"/>
  <link href="http://aemrox.github.io/"/>
  <updated>2016-01-25T19:26:43-05:00</updated>
  <id>http://aemrox.github.io/</id>
  <author>
    <name><![CDATA[Adam May]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Ruby-fied Javascript Part II: Currying]]></title>
    <link href="http://aemrox.github.io/blog/2016/01/25/ruby-fied-javascript-currying/"/>
    <updated>2016-01-25T14:11:44-05:00</updated>
    <id>http://aemrox.github.io/blog/2016/01/25/ruby-fied-javascript-currying</id>
    <content type="html"><![CDATA[
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Deploying Sinatra to Heroku, or How I Learned to Stop Worrying and Love Postgres]]></title>
    <link href="http://aemrox.github.io/blog/2016/01/04/deploying-to-heroku/"/>
    <updated>2016-01-04T13:27:07-05:00</updated>
    <id>http://aemrox.github.io/blog/2016/01/04/deploying-to-heroku</id>
    <content type="html"><![CDATA[<p>Ahh, my first foray into placing something on the real webs. I hope that one day I look back on this as a fond learning experience, with much nostalgia on how much I had ahead of me. But to be real, the path to that day seems as fraught and horrible as my path to getting this goddamn site up. To keep it brief, I not only suffered, but tortured my dog with many violent outbursts of fervent cussing.</p>

<p>Where to begin?</p>

<p>Let&rsquo;s start with what Heroku is. The wikipedia definition is a cloud platform-as-a-service. In plain old english, it&rsquo;s a way to host and serve your code online. Heroku is lots of web servers (called dynos) which are capable of holding your code, running it, and serving it to people who want to use it. It supports lots of different languages and frameworks, and can even provide you with any nuts and bolts your app might need (like security or databases). Up to a certain point, it&rsquo;s free and a great way for us to deploy our websites in a professional, scalable manner.</p>

<h2>Heroku&rsquo;s Documentation</h2>

<p>In short, the documentation is good. They do a great job of explaining, in a couple simple steps, how to get a rails app up and running with little to no effort.</p>

<p>Once you <a href="https://signup.heroku.com/signup/dc">sign up for a Heroku account</a> and download the <a href="https://devcenter.heroku.com/articles/getting-started-with-ruby#set-up">toolkit</a> you can upload an app with a few short command line requests:</p>

<p><code>$ heroku login</code></p>

<p>will bring up a field where you can enter the credentials for the account you created. Then, after navigating to repository of your app in your terminal, you can create a new app with the following command:</p>

<p><code>$ heroku create my_awesome_app</code></p>

<p>Now, all that&rsquo;s left to do is deploy your code. Luckily, heroku integrates seamlessly with git, so if you have a repository ready, you can push your entire codebase up with:</p>

<p><code>$ git push heroku master</code></p>

<p>If it seems to good to be true, that&rsquo;s because it is. The problem is, we are not using rails, we are using Sinatra - and on top of that, we&rsquo;re using the Tyrion Lanister of databases - sqlite3. It&rsquo;s totally functional, but it does not scale at all.</p>

<p style="text-align:center;"><img src="https://media4.giphy.com/media/Gqy93G8Ezezny/200.gif" alt="Tyrion" /></p>

<h2>Development Vs. Production</h2>

<p>Working with Sinatra and Heroku requires a lot of rejiggering. First off, you&rsquo;re going to need a few more gems, and you are going to need to start to really demarcate the difference between your Development and Production environments. Right now, we&rsquo;ve largely been working in what is considered Development environments.</p>

<p>An environment is the tier to which your code is deployed, or in short, where your code &ldquo;lives&rdquo;. The definition of a development environment is pretty loose, but in general it is an environment where code can be changed freely. No thought has to be given to making changes in the development environment because it&rsquo;s usually isolated, or running on a single server or machine. In our case, our development environment is our computer.</p>

<p>However, now that we are considering serving our web application to other people, and hosting in on heroku where it can be accessed by just about anyone, we have to rethink what our code is. It is no longer this malleable hunk of clay that we can change at will. It needs to be stable, and a lot of thought needs to go into how and when it is changed. Heroku is a production environment, one where the code and application is publicly accessible, or actively serving it&rsquo;s purpose.</p>

<p>In big companies, there are generally steps in between Development and Production (such as testing, quality assurance and staging), but for now let&rsquo;s focus on these two. So what does this mean for us? It means we have to start thinking about what it means to push something up to production. It&rsquo;s time to get serious.</p>

<p style="text-align:center;"><img src="https://cf.geekdo-images.com/images/pic323510.jpg" alt="warning shot" /></p>

<h2>Getting with the Postgres</h2>

<p>According to heroku, SQLite3 is not a production-grade database. Their reasoning as sound, and can be <a href="https://devcenter.heroku.com/articles/sqlite3">read here</a> if you are interested.</p>

<p>This means we are going to have to upgrade our databases. Postgres is fairly easy to get your hands on, it&rsquo;s open source and readily available. You might already have it installed.</p>

<p>If you don&rsquo;t you can do so by typing in:</p>

<p><code>brew install postgres</code></p>

<p>Now, we need to make sure that your postgres db launches automatically. There is a good guide <a href="http://www.tunnelsup.com/setting-up-postgres-on-mac-osx">here</a>, which I&rsquo;ll summarize quickly.</p>

<p>After you&rsquo;ve gotten postgres installed via brew, open it up in your finder and make sure it&rsquo;s running on your computer. Then you need to initialize your database, using the following command:</p>

<p><code>initdb /usr/local/var/postgres</code></p>

<p>You can continue following the instructions in order to get postgres to launch automatically, however, if you have it up and running right now, we can move on.</p>

<h2>Sinatra, you sweet, sweet lightweight fool</h2>

<p>This is where Sinatra falls short of Rails. Rails takes care of a lot of the plumbing for you, but in Sinatra, we are going to have to do it ourselves.</p>

<p>After including the &lsquo;pg&rsquo; gem in our gemfile, we are going to need to create a database.yml file in your config folder, right next to environment.rb.</p>

<p style="text-align:center;"><img src="http://i.imgur.com/TFZMqmw.png" alt="Database.yml in action" /></p>

<p>Here is a sample yaml file that serves as a decent template.</p>

<pre><code class="yaml">default: &amp;default
  adapter: postgresql
  pool: 5
  encoding: UTF8
  timeout: 5000
  port: 5432

development:
  &lt;&lt;: *default
  username: &lt;%= ENV['PG_USER'] %&gt;
  password: &lt;%= ENV['PG_PASS'] %&gt;
  database: db/my_db_development

test:
  &lt;&lt;: *default
  database: db/my_db_test

production:
  url: &lt;%= ENV["DATABASE_URL"] %&gt;
</code></pre>

<p>Two notes, the PG_USER and PG_PASS are environment variables that need to be set in your bash profile, thusly:</p>

<p><code>export PG_USER = 'flatiron'</code>
<code>export PG_PASS = 'learnlovecode'</code></p>

<p>You know, for safety reasons.</p>

<p>Second, the last line in this file is important for working with Heroku. Heroku will give your app an ENV (short for environment) hash with some data. In that hash is the database url, and will be essential for connecting the instance of a postgres db that heroku provides with your app.</p>

<p>Now we need to make sure that your gem file is divided into a development group, and includes the proper postgres gems. You will also need to include the &lsquo;pg&rsquo; gem, which will act as your adapter between active record and postgres - much like our sqlite3 gem has done up until now.</p>

<p>Heroku REALLY hates sqlite. Make sure you delete the sqlite3 gem from any mention in your gemfile. Also, go into your Gemfile.lock and delete any mentions of sqlite3 to remove any accidental dependencies (or just delete your Gemfile.lock). Make sure to run bundle install before you try to redeploy.</p>

<pre><code class="Ruby">source "https://rubygems.org"

ruby '2.2.3'
gem 'sinatra'
gem 'activerecord'
gem 'sinatra-activerecord'
gem 'sinatra-flash'
gem 'sinatra-redirect-with-flash'
gem 'rake'

#postgres!
gem 'postgresql'
gem 'pg'

group :development do
    gem 'pry'
    gem 'pry-nav'
  gem 'rspec'
    gem 'tux'
end
</code></pre>

<p>Next we move on to making the connection with active record. In your config/environment file, you will have to do some extra work to connect to postgres and make it compliant with Heroku. I took this piece of code from a <a href="http://mherman.org/blog/2013/06/08/designing-with-class-sinatra-plus-postgresql-plus-heroku/#.VonyepMrJE5">great guide for getting Sinatra to work with Postgres and Heroku</a>, so credit where credit is due.</p>

<pre><code class="Ruby">require 'bundler'
Bundler.require(:default, :development, :production)

configure :production, :development do
  db =  URI.parse(ENV['DATABASE_URL'] || 'postgres://localhost/[the name you gave your db in your yaml file]')
#  db =  'postgres://localhost/topofthemorning_development'

  ActiveRecord::Base.establish_connection(
    :adapter  =&gt; db.scheme == 'postgres' ? 'postgresql' : db.scheme,
    :host     =&gt; db.host,
    :username =&gt; db.user,
    :password =&gt; db.password,
    :database =&gt; db.path[1..-1],
    :encoding =&gt; 'UTF8'

  )
end

require_relative '../app/controllers/application_controller.rb'
require_all 'app/models'

require "open-uri"
require "json"
</code></pre>

<p>The fifth line of code sets the database connection. It first checks to see if it&rsquo;s being served with a url (which we received from Heroku and assigned in our database.yml file), otherwise it uses the database we set up in our yml file.</p>

<p>As another note, make sure you name your local db on the other end of the || the same as you did in the database.yml file.</p>

<p>And that should do it! Your postgres db should be running locally just fine (really you should probably check). You can redeploy your app to heroku (with the <code>git push heroku master</code> command) and it should be up and running!</p>

<p>Keep in mind if your db has any data in it before, it will be gone now!</p>

<h2>Full Disclosure</h2>

<p>I did not get this far on my own at all. Seriously, as of first writing this, my shit still didn&rsquo;t work. Thanks to help from some awesome people (thanks Sophie and Joe!), I&rsquo;ve gotten it up and running.</p>

<p>However, that being said, I have a few pitfalls to avoid and few hints to give you so you can dodge the cesspit I found myself mired in for a few days.</p>

<ol>
<li>When you make changes to your code, you need to push them up to git before you push them up to heroku. When you push to Heroku, it&rsquo;s coming from your git repository, not your local files.</li>
<li>Postgres is a lot stricter on the &lsquo;foreign key&rsquo; constraint. If you write your migrations with belongs_to relationships, and define foreign keys, make sure that the table already exists in a previous migration. Sqlite3 will let that shit slide, but postgres is a lot less forgiving.</li>
<li>Pry doesn&rsquo;t work in your heroku! If you&rsquo;re code is broken it is much harder to fix once in a production environment. SO - a solid tip is make sure your code is working before you deploy it.</li>
<li>So Pry doesn&rsquo;t work, but you can still do some spot debugging by writing some rake tasks. For instance, if I want to see what&rsquo;s going on in my environment db, I can write some rake tasks to display the contents of a few of my models.</li>
<li>Rake tasks are an awesome way to interact with your code in general once it&rsquo;s in environment, having some tasks is a great way to do some maintenancy things, like clearing your db, or resetting a user, etc.</li>
<li>Make sure to set your public folder explicitly in your app controller! Otherwise, heroku will not serve your CSS, images, or any other files you link to your html from your public folder. Do so like this right in your application controller:
<code>Ruby
set :public_folder, File.join(root, "../../public")
</code></li>
</ol>


<p>That&rsquo;s all I got guys, hopefully, once you tune in next time this will be further down the road. You know what they say, when you shoot for the stars and miss, at least you still have cat gifs:</p>

<p style="text-align:center;"><img src="https://media0.giphy.com/media/jO161HOYUPKEM/200.gif" alt="failcat" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The Wonderful World of Regex]]></title>
    <link href="http://aemrox.github.io/blog/2015/12/08/the-wonderful-world-of-regex/"/>
    <updated>2015-12-08T13:52:56-05:00</updated>
    <id>http://aemrox.github.io/blog/2015/12/08/the-wonderful-world-of-regex</id>
    <content type="html"><![CDATA[<p>While working on my last project, our main goal was solving one very difficult problem.</p>

<p>While ingesting around 1,000 articles a day, we needed to add some semblance of location data to each one of those articles. When we first launched, this was done by me. Manually. All. Goddamn. Day.</p>

<p>I would manually scan the article for some kind of address, or area (like 5th ave between 42nd and 43rd). We noticed that I was following very similar patterns - addresses are generally clean patterns, and areas often use the same prepositions over and over again. My partner figured that we could begin parsing these texts automatically with a series of rules.</p>

<p>Since I was not any kind of developer at the time, I was less involved with the coding of the solution, but one way I was able to chip in was in writing the logic of finding these phrases through something called Regex.</p>

<p>Regex stands for Regular Expressions, and is a very powerful tool used for identifying, matching and capturing certain patterns in text and strings.</p>

<p>We would write regular expressions to begin automatically filtering and flagging the articles we were pulling in for items that didn’t fit what we were doing, like sponsored advertising:</p>

<p><code>/sponsored/i</code></p>

<p>But more importantly, we wrote a series of expressions that would look for the prepositions connecting areas, or the patterns of addresses. Here are some of the finished products:</p>

<p><code>\b([0-9]+ (West|W|East|E|North|N|South|S) [0-9]+(st|nd|rd|th))\b</code></p>

<p><code>((East|West)? ?([0-9]+|[A-Z][a-z]+|first|second|third|[a-z]+th)(st|th|nd|rd)? ?(Road|road|rd|Rd|Street|street|St|st|Avenue|avenue|Ave|ave|Place|place|Pl|pl|Parkway|parkway|pk|Pkwy|pkwy|Drive|drive|Dr|dr|Boulevard|boulevard|Blvd|blvd|Way|way|Lane|lane|Ln|ln|Court|court|Plaza|plaza|Square|Terrace|terrace)) +(near|and|at) +(Avenue [A-Z])\b</code></p>

<p>But let’s not get ahead of ourselves. Let’s start with the basics of Regex.</p>

<h3>How it works</h3>

<p>At its most basic, regex is just writing expressions that try to match combinations of characters. Every string can be broken down into characters, so we should be able to codify some kind of logic that allows us to build up every combination we see in the real world. That’s what the regex engine does.</p>

<p>Ruby recognizes regular expressions when you offset them by two backslashes, or with %r()</p>

<p><code>/this is a regex expression/  
%r(and this is to!)</code></p>

<p>and these expressions can be entered in String.#methods such as #Scan or #Split</p>

<h2>Basic Rules</h2>

<p>Regex recognizes all of our basic characters, so if you were to just type in a word it would match:</p>

<p><img src="https://github.com/Aemrox/aemrox.github.io/blob/source/source/images/Basic%20Match.png?raw=true" alt="Basic Match Image" /></p>

<p>There are also modifiers that you can add to the end of expressions, such as “i”, which allows you to recognize any case:</p>

<p>![Case Capture Image]<a href="https://github.com/Aemrox/aemrox.github.io/blob/source/source/images/Case%20Match.png?raw=true">https://github.com/Aemrox/aemrox.github.io/blob/source/source/images/Case%20Match.png?raw=true</a></p>

<p>You can also capture ranges of characters. Capture any lower case character with the following syntax:</p>

<p><img src="https://github.com/Aemrox/aemrox.github.io/blob/source/source/images/Range%20Match.png?raw=true" alt="match all lower case letters" /></p>

<p>the little g modifier at the ends means it is global, and will match every instance across the string. If we were to remove it, it would only match the first instance.</p>

<p>Beyond basic characters, you can also match punctuation and white space by using escape characters:</p>

<p><img src="https://github.com/Aemrox/aemrox.github.io/blob/source/source/images/Periods.png?raw=true" alt="periods" />
<img src="https://github.com/Aemrox/aemrox.github.io/blob/source/source/images/White%20Space.png?raw=true" alt="whitesspace" /></p>

<p>The reason for needing the escape character is that there are special characters which denote larger sets, such as the “.” which matches any character</p>

<p><img src="https://github.com/Aemrox/aemrox.github.io/blob/source/source/images/Dot.png?raw=true" alt="Dot" /></p>

<p>There are also some special characters that regex uses to look at more complex concepts, such as words characters
\w for words!
<img src="https://github.com/Aemrox/aemrox.github.io/blob/source/source/images/word%20characters.png?raw=true" alt="words characters" /></p>

<p>You can also do the same for digits with \d</p>

<p><img src="https://github.com/Aemrox/aemrox.github.io/blob/source/source/images/digits.png?raw=true" alt="digits" /></p>

<h2>Capture Groups</h2>

<p>Everything we have been doing so far has been restricted to matching a single phrase. However, regex has a lot more potential than just that. You can instruct an expression to group certain matches, or even break down a phrase by using what are called capture groups.</p>

<p>These are particularly useful when using a string method like #scan, which utlizes these groups and places them as separate entries in an array.</p>

<p>You create a group by placing a parenthessis around what you are looking to capture. a parenthesis captures only an entire phrase.</p>

<p><img src="https://cdn-images-1.medium.com/max/800/1*AdPVsSKG1taPW7zJgRoFrA.png" alt="Basic Capture Group" /></p>

<p>However, you can also define a capture group with brackets, which will match any character in the group.</p>

<p><img src="https://raw.githubusercontent.com/Aemrox/aemrox.github.io/master/images/Case%20Match.png" alt="Capture using Brackets" /></p>

<p>These kinds of expressions are excellent for splitting up strings. The following piece of code does a decent job of splitting up strings by sentences. See if you can decipher the regex!</p>

<p><code>“Check out my sentence! Here’s another. And another?”.split(/[.!?]/)</code></p>

<h2>Quantifiers</h2>

<p>Unless otherwise specified - most capture groups will capture each instance of a match as an individual capture. However, we can use several quantifiers to modify how capture groups behave and give them more (or less) flexibility</p>

<p>If we look back at our expression to split strings, it works pretty well, but fails if we have two periods in a row:</p>

<p><code>string = "This. should. split well... but it doesnt!!".split(/[.!?]/)  # =&gt; ["This", " should", " split", "", " but it doesnt"]</code></p>

<p>This doesn’t do exactly what we want because the capture group is matching each occurrence of the expression. We can fix this with the + quantifier. The + quantifier can be appended to a capture group to make it match 1 or more occurrences of the expression. This will chain all occurrences of the capture group that occur side by side into one capture. So we can fix our code like this:</p>

<p><code>"This. should. split well... and it does!!!".split(/[.!?]+/)  # =&gt; ["This", " should", " split well", " and it does"]</code></p>

<p>Another excellent modifier is the * or splat. When placed inside a capture group, it takes the preceeding token, and tells regex to match as many of these as possible.</p>

<p><img src="https://github.com/Aemrox/aemrox.github.io/blob/source/source/images/Splat.png?raw=true" alt="Splat" /></p>

<p>One more modifier that I think is really good to go over is the ?. It is called the optional modifier. What it means is capture 0 or 1 of the preceding token. Here it is in action:</p>

<p><img src="https://github.com/Aemrox/aemrox.github.io/blob/source/source/images/Optional%20Modifier.png?raw=true" alt="optional modifier" /></p>

<p>However, ? can also mean lazy, which we’ll dive into below.</p>

<h2>Greedy Vs. Lazy</h2>

<p>This is one of the tougher concepts to grasp in Regex, at least for me, so I’m going to do my best to explain it.</p>

<p>the * quantifier is called the “greedy” quantifier. It will take as many characters as necessary to create a capture group. To understand this, look at the following string.</p>

<p>“You are becoming quite skilled, young grasshopper,” said Steven with glowing admiration in his eyes. “quite skilled indeed.”</p>

<p>If I wanted a regex expression to match “anything between the quotes” - it actually has several groups it could capture. It could do both traditional quotes (as we see them), it could take the inverse, which is the area between the 2nd and 3rd quotation mark, or it could take the whole sentence.</p>

<p>So a * tells regex, take as many characters as possible, or, be greedy.</p>

<p>This is best displayed below:</p>

<p><img src="https://github.com/Aemrox/aemrox.github.io/blob/source/source/images/Greedy.png?raw=true" alt="greedy" /></p>

<p>This doesn’t get us all the text in quotations as we see them. B ecause we placed a * quantifier, it matches as many characters as possible.</p>

<p>if ? is used on another quantifier, it can be made to make the group “lazy” or match as few characters as possible to make the capture effective. This is a bit of a mental leap, so just look at it in action below.</p>

<p><img src="https://github.com/Aemrox/aemrox.github.io/blob/source/source/images/Lazy.png?raw=true" alt="lazy" /></p>

<p>There are a ton of amazing things regex can do, way too much to go over in one blog post. But hopefully this gives you guys a good start, and if this sparked your interest, keep reading for a few great resources to learn more on your own!</p>

<p><a href="http://regexr.com/">http://regexr.com/</a> - how I did some of the images</p>

<p><a href="http://rubular.com/">http://rubular.com/</a> - the right tool to use to build regex for Ruby, uses the same engine.</p>

<p><a href="http://regexone.com/">http://regexone.com/</a> - a great tutorial that Kaylee found! Thanks Kaylee.</p>

<p><a href="https://regex101.com/">https://regex101.com/</a> - from Derek. Thanks Derek&hellip;</p>

<p><a href="http://www.rexegg.com/">http://www.rexegg.com/</a> - for those of you looking to master the whole thing and see how far down the rabbit whole you can go.</p>
]]></content>
  </entry>
  
</feed>
